using System;
using AMSI_Hooks.AntiMalwareScanInterface;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using UnitTests.Helpers;

namespace UnitTests.AMSI_Hook_Tests
{
    [TestClass]
    public class AntiMalwareScanInterfaceTests
    {
        [TestMethod]
        public void RandomString_Is_Not_Detected()
        {
            //arange
            var sample = RandomData.RandomString(10);
            var AMSI_Provider = new AntiMalwareScanInterface();

            //act
            var detection = AMSI_Provider.CallAntimalwareScanInterface(sample);

            //assert
            Assert.AreEqual(false, detection, "Sample should not be deteceted.");
        }

        [TestMethod]
        public void EICAR_Is_Detected()
        {
            //arange
            var sample1 = @"X5O!P%@AP[4\PZX54(P^)7CC)7}$EIC";
            var sample2 = @"AR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*";
            var AMSI_Provider = new AntiMalwareScanInterface();

            //act
            var detection = AMSI_Provider.CallAntimalwareScanInterface(sample1 + sample2);

            //assert
            Assert.AreEqual(true, detection, "EICAR file should be detected");
        }
    }
}
